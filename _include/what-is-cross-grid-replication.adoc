//shared section for the tenant manager and the grid manager

== What is cross-grid replication?

Cross-grid replication is the automatic replication of objects between selected S3 buckets in two StorageGRID systems that are connected in a xref:../admin/grid-federation-overview.adoc[grid federation connection].

=== Considerations and requirements for cross-grid replication

To use cross-grid replication:

* A grid admin creates a tenant account and assigns the *Use grid federation connection* permission for a specific grid federation connection. When the new tenant is saved, an identical tenant is automatically created on the other grid in the connection.

* A tenant user signs in the account on each grid and creates identical new buckets. These buckets: 

** Must have the same name and region
** Must have versioning enabled
** Must have S3 Object Lock disabled
** Must be empty
** Must not use bucket-level encryption

* A tenant user updates bucket settings to enable cross-grid replication. Replication can be configured to occur between buckets in one direction or in both directions.

==== [[replication-one-direction]]Replication in one direction

If you enable cross-grid replication for a bucket on only one grid, objects added to that bucket are replicated to the other grid, but objects added to the other bucket are not. In the figure, cross-grid replication is enabled for `my-bucket` from Grid 1 to Grid 2, but it is not enabled in the other direction. 

image:../media/grid-federation-cross-grid-replication-one-direction.png[image showing grid federation connection in one direction]

==== [[replication-both-directions]]Replication in both directions
If you enable cross-grid replication for the same bucket on both grids, objects added to either bucket are replicated to the other grid. In the figure, cross-grid replication is enabled for `my-bucket` in both directions. 

image:../media/grid-federation-cross-grid-replication.png[image showing replication in one direction vs replication in both directions]

==== [[client-deletes]]Replication of client delete markers

When enabling cross-grid replication for a bucket, you can specify what happens when objects in the bucket are deleted by S3 client operations.

* If you choose to replicate client delete markers, a delete marker is added to the source bucket and replicated to the destination bucket when an S3 client deletes an object. In effect, objects are deleted on both grids.

*  If you choose not to replicate client delete markers, a delete marker is added to the source bucket, but it is not replicated to the destination bucket. In effect, objects that are deleted on the source grid are not deleted on the destination grid.

In the figure, the grids are configured for cross-grid replication in both directions, but client delete markers are not replicated from `my-bucket` on Grid 1 to `my-bucket` on Grid 2.

image:../media/grid-federation-cross-grid-replication-delete.png[image showing replicate client delete on both grids]
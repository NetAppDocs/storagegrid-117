//shared section for the tenant manager and the grid manager

== What is account clone?

Account clone is the automatic replication of selected S3 tenant accounts, users, and groups between two StorageGRID systems. Account clone is required for cross-grid replication. Using cloned accounts ensures that the same tenant users and groups can access the corresponding buckets on each grid.

=== Considerations and requirements for creating tenants

To create the tenants that will own the buckets used for cross-grid replication, a grid admin follows the standard tenant-creation steps but adds the *Use grid federation connection* permission for a specific grid federation connection. When a new tenant with that permission is saved, StorageGRID automatically creates a replica of that tenant on the other grid. 

The grid where the tenant is originally created is known as the tenant's _source grid_. The grid where the tenant is replicated to is known as the tenant's _destination grid_. Both tenant accounts have the same account ID, name, storage quota, and assigned permissions, but the tenant replicated to the destination grid has fewer capabilities and does not initially have a root user password.

The *Use grid federation connection* permission can be selected for a new tenant account only. This permission can't be added to an existing account.

=== Considerations and requirements for cloning users and groups

After tenants have been created and replicated, new groups and users are automatically cloned from the tenant's source grid to the tenant's destination grid. As the figure shows:

* Assuming the <<account-clone-identity-federation,requirements for identity federation>> have been met, federated groups imported to the tenant on the source grid are automatically imported to the tenant on the destination grid. The group permissions and S3 policy are the same.

* Local tenant groups and users created on the source grid are automatically cloned to the destination grid.

* Optionally, S3 access keys created on the source grid can be manually cloned to the destination grid. See <<account-clone-access-keys,Considerations for cloning access keys>>.
+
image:../media/grid-federation-account-clone.png[image showing that tenant details are cloned from source grid to destination grid]

In contrast, any groups, users, and S3 access keys created on the destination grid are not cloned to the source grid. 

image:../media/grid-federation-account-not-cloned.png[image showing that tenant details are cloned back to source grid]

Any edits made to the tenant, users, groups, or access keys on either grid are not cloned to the other grid. 

=== [[account-clone-access-keys]]Considerations and requirements for cloning S3 access keys

For security reasons, StorageGRID does not clone S3 access keys from the tenant's source grid to the destination grid. If tenant users need to access the buckets on both grids, you must use the Tenant Manager API to manually copy the keys from the source grid to the destination grid. See xref:../tenant/grid-federation-clone-keys-with-api.adoc[Clone S3 access keys using the API].

[IMPORTANT]
You must clone a federated user's S3 access keys to the destination grid before that user will be allowed to access the destination grid.


=== [[account-clone-identity-federation]]Considerations and requirements for SSO and identity federation

* If you use identity federation with single sign-on (SSO), the administrator for each grid in the grid federation connection must configure the same identity source and the same SSO identity provider (IdP).

* If you use identity federation without SSO, either the grid admin or a tenant user must configure the same identity source for both grids. Tenant accounts that have the *Use own identity source* permission must configure the same identity source for both the source and destination tenant accounts. 




---
permalink: ilm/create-ilm-rule-define-placements.html
sidebar: sidebar
keywords: ilm rule step 2, define placements
summary: 'Step 3 \(Define placements\) of the Create ILM Rule wizard allows you to define the placement instructions that determine how long objects are stored, the type of copies \(replicated or erasure coded\), the storage location, and the number of copies.'
---
= Step 2 of 3: Define placements
:icons: font
:imagesdir: ../media/

[.lead]
The *Define placements* step of the Create ILM Rule wizard allows you to define the placement instructions that determine how long objects are stored, the type of copies (replicated or erasure coded), the storage location, and the number of copies.

.About this task

An ILM rule can include one or more placement instructions. Each placement instruction applies to a single period of time. When you use more than one instruction, the time periods must be contiguous, and at least one instruction must start on day 0. The instructions can continue either forever, or until you no longer require any object copies.

Each placement instruction can have multiple lines if you want to create different types of copies or use different locations during that time period.

This example ILM rule creates two replicated copies for the first year. Each copy is saved in a storage pool at a different site. After one year, a 2+1 erasure-coded copy is made and saved at only one site.

image::../media/ilm_create_ilm_rule_wizard_2.png[Create ILM Rule Wizard Page 2]

.Steps

. For *Reference time*, select the type of time to use when calculating the start time for a placement instruction.
+
[cols="1a,2a" options="header"]
|===
| Option| Description

|Ingest time
|The time when the object was ingested.

|Last access time
|The time when the object was last retrieved (read or viewed).

*Note:* To use this option, updates to Last access time must be enabled for the S3 bucket or Swift container. See xref:using-last-access-time-in-ilm-rules.adoc[Use Last access time in ILM rules].

|User defined creation time
|A time specified in user-defined metadata.
|===
+
NOTE: If you want to create a compliant rule, you must select *Ingest time*.
+
. In the *Time period and placements* section, select a starting time and a duration for the first time period.
+
For example, you might want to specify where to store objects for the first year ("`day 0 for 365 days`"). At least one instruction must start at day 0.

. If you want to create replicated copies:
 .. From the *Store objects by* drop-down list, select *replicating*.
 .. In the *copies at* field, select the storage pools you want to add.
+
*If you specify only one storage pool*, be aware that StorageGRID can store only one replicated copy of an object on any given Storage Node. If your grid includes three Storage Nodes and you select 4 as the number of copies, only three copies will be made&#8212;one copy for each Storage Node.
+
NOTE: The *ILM placement unachievable* alert is triggered to indicate that the ILM rule could not be completely applied.
+
*If you specify more than one storage pool*, keep these rules in mind:

  *** The number of copies cannot be greater than the number of storage pools.
  *** If the number of copies equals the number of storage pools, one copy of the object is stored in each storage pool.
  *** If the number of copies is less than the number of storage pools, the system distributes the copies to keep disk usage among the pools balanced, while ensuring that no site gets more than one copy of an object.
  *** If the storage pools overlap (contain the same Storage Nodes), all copies of the object might be saved at only one site. For this reason, do not specify the default All Storage Nodes storage pool and another storage pool.

.. Select the number of copies you want to make.
+
A warning appears if you change the number of copies to 1. An ILM rule that creates only one replicated copy for any time period puts data at risk of permanent loss. See xref:why-you-should-not-use-single-copy-replication.adoc[Why you should not use single-copy replication].
+
To avoid these risks, do one or more of the following:

*** Increase the number of copies for the time period.
*** Select the plus sign icon image:../media/icon_plus_sign_black_on_white.gif[plus sign black on white] to create additional copies during the time period. Then, select a different storage pool or a Cloud Storage Pool.
*** Select *erasure coded* for Type, instead of *replicated*.
You can safely ignore this warning if this rule already creates multiple copies for all time periods.

. If you want to create an erasure-coded copy:
 .. From the *Type* drop-down list, select *erasure coded*.
+
The number of copies changes to 1. A warning appears if the rule does not have an advanced filter to ignore objects that are 200 KB or smaller.
+
IMPORTANT: Erasure coding is best suited for objects greater than 1 MB. Do not use erasure coding for objects smaller than 200 KB to avoid the overhead of managing very small erasure-coded fragments.

 .. If the object size warning appeared, select *Previous* to return to Step 1. Then, select *Add an advanced filter* and set the Object Size (MB) filter to any value greater than 0.2.
 .. Select the storage location.
+
The storage location for an erasure-coded copy includes the name of the storage pool, followed by the name of the Erasure Coding profile.

. Optionally, add different time periods or create additional copies at different locations:
 ** Select the plus icon to create additional copies at a different location during the same time period.
 ** Select *Add* to add a different time period to the placement instructions.
+
NOTE: Objects are automatically deleted at the end of the final time period unless the final time period ends with *forever*.

. If you want to store objects in a Cloud Storage Pool:
 .. From the *Type* drop-down list, select *replicated*.
 .. In the *Location* field, select *Add Pool*. Then, select a Cloud Storage Pool.
+
When using Cloud Storage Pools, keep these rules in mind:

  *** You cannot select more than one Cloud Storage Pool in a single placement instruction. Similarly, you cannot select a Cloud Storage Pool and a storage pool in the same placement instruction.

  *** You can store only one copy of an object in any given Cloud Storage Pool. An error message appears if you set *Copies* to 2 or more.

  *** You cannot store more than one object copy in any Cloud Storage Pool at the same time. An error message appears if multiple placements that use a Cloud Storage Pool have overlapping dates or if multiple lines in the same placement use a Cloud Storage Pool.

  *** You can store an object in a Cloud Storage Pool at the same time that object is being stored as replicated or erasure coded copies in StorageGRID. However, as this example shows, you must include more than one line in the placement instruction for the time period, so you can specify the number and types of copies for each location.

. Select *Refresh* to update the Retention diagram and to confirm your placement instructions.
+
Each line in the diagram shows where and when object copies will be placed. The color of a line represents the type of copy:
+
[cols="1a,4a"]
|===
|image:../media/retention_diag_replicated_copy_color.png[Color for replicated copy]
|Replicated copy

|image:../media/retention_diag_ec_copy_color.png[Color for erasure coded copy]
|Erasure-coded copy

|image:../media/retention_diag_csp_copy_color.png[Color for Cloud Storage Pool copy]
|Cloud Storage Pool copy
|===
+
In this example, two replicated copies will be saved to two storage pools (Data Center 1 and Data Center 2) for one year. Then, an erasure-coded copy will be saved for an additional 10 years, using a 6+3 erasure-coding scheme at three sites. After 11 years, the objects will be deleted from StorageGRID.
+
image::../media/ilm_rule_retention_diagram.png[ILM Rule Retention Diagram]

. Select *Continue*. xref:create-ilm-rule-select-ingest-behavior.adoc[Step 3 (Select ingest behavior)] of the Create an ILM rule wizard appears.
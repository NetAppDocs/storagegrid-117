---
permalink: ilm/creating-ilm-policy-after-s3-object-lock-is-enabled.html
sidebar: sidebar
keywords: how to create ILM policy, policy for S3 object lock
summary: 'If the global S3 Object Lock setting is enabled, the steps for creating a policy are slightly different. You must ensure that the ILM policy is compliant with the requirements of buckets that have S3 Object Lock enabled.'
---
= Create an ILM policy after S3 Object Lock is enabled
:icons: font
:imagesdir: ../media/

[.lead]
If the global S3 Object Lock setting is enabled, the steps for creating a policy are slightly different. You must ensure that the ILM policy is compliant with the requirements of buckets that have S3 Object Lock enabled.

.What you'll need

* You are signed in to the Grid Manager using a xref:../admin/web-browser-requirements.adoc[supported web browser].
* You have the xref:../admin/admin-group-permissions.adoc[required access permissions].
* The global S3 Object Lock setting is already enabled for the StorageGRID system.
+
NOTE: If the global S3 Object Lock setting has not been enabled, use the general instructions for xref:creating-proposed-ilm-policy.adoc[creating a proposed ILM policy].

* You have created the compliant and non-compliant ILM rules you want to add to the proposed policy. As required, you can save a proposed policy, create additional rules, and then edit the proposed policy to add the new rules. See
xref:example-7-compliant-ilm-policy-for-s3-object-lock.adoc[Example 7: Compliant ILM policy for S3 Object Lock].

* You have xref:creating-default-ilm-rule.adoc[created a default ILM rule] for the policy that is compliant.

* Optionally, you have watched the video: https://netapp.hosted.panopto.com/Panopto/Pages/Viewer.aspx?id=c929e94e-353a-4375-b112-acc5013c81c7[Video: StorageGRID ILM Policies^]
+
image::../media/video-screenshot-ilm-policies.png[link="https://netapp.hosted.panopto.com/Panopto/Pages/Viewer.aspx?id=c929e94e-353a-4375-b112-acc5013c81c7" alt="Video: StorageGRID ILM Policies", window=_blank]


.Steps

. Select *ILM* > *Policies*.
+
If the global S3 Object Lock setting is enabled, the ILM policies page indicates which ILM rules are compliant.

. Determine how you want to create the proposed ILM policy.

//tabbed blocks start here

[role="tabbed-block"]
====

.Start from scratch
--

.. If a proposed ILM policy currently exists, select that policy, and select *Delete*.
+
You cannot create a new proposed policy if a proposed policy already exists.

.. Select *Create proposed policy*.

--
//end no rules selected, begin Based on active policy

.Start with rules from active policy
--

.. If a proposed ILM policy currently exists, select that policy, and select *Delete*.
+
You cannot clone the active policy if a proposed policy already exists.

.. Select *Create proposed policy* > *Clone active policy*.

--
//end Based on active, begin Edit existing

.Edit existing proposed policy

 .. Select the proposed policy.
 .. Select *Actions* > *Edit*.

====
//end tabbed blocks

[start=3]
. In the *Proposed policy name* field, enter a unique name for the proposed policy. Enter at least 1 and no more than 64 characters.

. In the *Reason for change* field, enter the reason you are creating a new proposed policy. Enter at least 1 and no more than 128 characters.

. To add rules to the policy, select *Select rules*.

. Select a rule name or the more details icon image:../media/icon_nms_more_details.gif[more details icon] to view the settings for that rule.

. Select one default rule for the proposed policy. To create a new default rule, select *ILM rules page* image:../media/icon_nms_more_details.gif[more details icon].
+
The list of rules contains only the rules that are compliant and do not use any filters. Periodically, the list is automatically updated to reflect additions or removals. If a rule is removed after you select it, an error message appears.
+
IMPORTANT: Do not use the Make 2 Copies rule as the default rule for a policy. The Make 2 Copies rule uses a single storage pool, All Storage Nodes, which contains all sites. If you use this rule, multiple copies of an object might be placed on the same site.

. Select *Continue*.

. For the Select other rules step, select any other compliant or non-compliant rules you want to include in the policy.
+
The other rules must use at least one filter (tenant account, bucket name, or an advanced filter, such as object size).
+
.. If you need a different "`default`" rule for objects in non-compliant S3 buckets, select the check box, *Include a rule without filters for non-compliant S3 buckets*, and select one non-compliant rule that does not use a filter.
+
For example, you might want to use a Cloud Storage Pool or an Archive Node to store objects in buckets that do not have S3 Object Lock enabled.
+
NOTE: You can only select one non-compliant rule that does not use a filter.

.. Select any other compliant or non-compliant rules you want to use in the policy.

. When you are done selecting the rules, select *Select*.
+
The rules you selected are listed. The default rule is at the end, with the other rules above it. If you also selected a non-compliant "`default`" rule, that rule is added as the second-to-last rule in the policy.

. Drag and drop the rows for the non-default rules to determine the order in which these rules will be evaluated.
+
You cannot move the default rule or the non-compliant "`default`" rule.
+
IMPORTANT: You must confirm that the ILM rules are in the correct order. When the policy is activated, new and existing objects are evaluated by the rules in the order listed, starting at the top.

. As required, select *Select rules* to add or remove rules.

. When you are done, select *Save*.

. Go to xref:simulating-ilm-policy.adoc[Simulate an ILM policy].

---
permalink: admin/use-s3-setup-wizard-steps.html
sidebar: sidebar
keywords: FabricPool and S3 setup wizard, S3
summary: 'You can use the S3 setup wizard to configure StorageGRID as the object storage system for an S3 application.'
---
= Access and complete the S3 application setup wizard
:icons: font
:imagesdir: ../media/

[.lead]
You can use the S3 application setup wizard to configure StorageGRID for use with an S3 application. The setup wizard provides the values the application needs to access a StorageGRID bucket and to save objects.

NOTE: You must have the Root access permission to access the wizard.

== Access the wizard

. Sign in to the Grid Manager using a xref:../admin/web-browser-requirements.adoc[supported web browser].

. If the *FabricPool and S3 setup wizard* banner appears on the dashboard, select the link in the banner. If the banner no longer appears, select the help icon from the header bar in the Grid Manager and select *FabricPool and S3 Setup Wizard*.
+
image::../media/help_menu.png[help menu]
. In the S3 application section of the FabricPool and S3 setup wizard page, select *Configure now*.
+
*Step 1 of 6: Configure HA group* appears.

== Step 1 of 6: Configure HA group
A high availability (HA) group is a collection of nodes that each contain the StorageGRID Load Balancer service. An HA group can contain Gateway Nodes, Admin Nodes, or both.

You can use an HA group to help keep the S3 application data connections available. If the active interface in the HA group fails, a backup interface can manage the workload with little impact to S3 operations.

For details about this task, see xref:../admin/managing-high-availability-groups.adoc[Manage high availability groups] and xref:best-practices-for-high-availability-groups.adoc[Best practices for high availability groups].

. If you plan to use an external load balancer, you do not need to create an HA group. Select *Skip this step* and go to <<Step 2 of 6: Configure load balancer endpoint>>.

. To use the StorageGRID load balancer, you can create a new HA group or use an existing HA group.


// start tabbed area

[role="tabbed-block"]
====

.Create HA group
--

.. To create a new HA group, select *Create HA group*.

.. For the *Enter details* step, complete the following fields.
+
[cols="1a,2a" options="header"]
|===
| Field| Description

|HA group name
|A unique display name for this HA group.

|Description (optional)
|The description of this HA group.

|===

.. Select *Continue*.
.. For the *Add interfaces* step, select the node interfaces you want to use in this HA group.
+
Use the column headers to sort the rows, or enter a search term to locate interfaces more quickly.
+ 
You can select one or more nodes, but you can select only one interface for each node.

.. For the *Prioritize interfaces* step, determine the Primary interface and any backup interfaces for this HA group.
+
Drag and drop rows to change the values in the *Priority order* column.
+
The first interface in the list is the Primary interface. The Primary interface is the active interface unless a failure occurs.
+
If the HA group includes more than one interface and the active interface fails, the virtual IP (VIP) addresses move to the first backup interface in the priority order. If that interface fails, the VIP addresses move to the next backup interface, and so on. When failures are resolved, the VIP addresses move back to highest priority interface available.

.. For the *Enter IP addresses* step, complete the following fields.
+
[cols="1a,2a" options="header"]
|===
| Field| Description

|Subnet CIDR
|The address of the VIP subnet in CIDR notation&#8212;an IPv4 address followed by a slash and the subnet length (0-32). 

The network address must not have any host bits set. For example, `192.16.0.0/22`.

|Gateway IP address (optional)
|Optional. If the S3 IP addresses used to access StorageGRID are not on the same subnet as the StorageGRID VIP addresses, enter the StorageGRID VIP local gateway IP address. The local gateway IP address must be within the VIP subnet.

|Virtual IP address
|Enter at least one and no more than ten VIP addresses for the active interface in the HA group. All VIP addresses must be within the VIP subnet.

At least one address must be IPv4. Optionally, you can specify additional IPv4 and IPv6 addresses.

|===

.. Select *Create HA group* and then select *Finish* to return to the FabricPool and S3 setup wizard.
.. Select *Continue* to go to the load balancer step.
--

.Use existing HA group
--
.. To use an existing HA group, select the HA group name from the *Select an HA group* drop-down list. 
.. Select *Continue* to go to the load balancer step. 
--
====

// end tabbed area


== Step 2 of 6: Configure load balancer endpoint

StorageGRID uses a load balancer to manage the workload from client applications. Load balancing maximizes speed and connection capacity across multiple Storage Nodes.

You can use the StorageGRID Load Balancer service, which exists on all Gateway and Admin Nodes, or you can connect to an external (third-party) load balancer. Using the StorageGRID load balancer is recommended.

For details about this task, see xref:../admin/configuring-load-balancer-endpoints.adoc[Configure load balancer endpoints] and xref:best-practices-for-load-balancing.adoc[Best practices for load balancing].

To use the StorageGRID Load Balancer service, select the *StorageGRID load balancer* tab and then create or select the load balancer endpoint you want to use. To use an external load balancer, select the *External load balancer* tab and provide details about the system you have already configured. 

[role="tabbed-block"]
====

.Create endpoint
--

. To create a load balancer endpoint, select *Create endpoint*.
. For the *Enter endpoint details* step, complete the following fields.
+
[cols="1a,2a" options="header"]
|===
|Field| Description

|Name
|A descriptive name for the endpoint.

|Port
|The StorageGRID port you want to use for load balancing. This field defaults to 10433 for the first endpoint you create, but you can enter any unused external port. If you enter 80 or 443, the endpoint is configured only on Gateway Nodes, since these ports are reserved on Admin Nodes.

*Note:* Ports used by other grid services are not permitted. See the 
xref:../network/network-port-reference.adoc[Network port reference].

|Client type
|Must be *S3*.

|Network protocol
|Select *HTTPS*.

*Note*: Communicating with StorageGRID without TLS encryption is supported but not recommended.

|===

. Select *Continue*.

. For the *Select binding mode* step, specify the binding mode. The binding mode controls how the endpoint is accessed&#8212;using any IP address or using specific IP addresses and network interfaces.
+
[cols="1a,2a" options="header"]
|===
|Option| Description

|Global
|Clients can access the endpoint using the IP address of any Gateway Node or Admin Node, or the virtual IP (VIP) address of any HA group. This is the default and recommended setting.

|Node interfaces
|Clients can only access the endpoint using the IP address of a selected node and network interface.

|HA groups VIPs
|Clients can only access the endpoint using a VIP address of an HA group. Use this selection only if you require much higher levels of isolation of workloads.

|===
 
. Select *Continue*.

. For the *Attach certificate* step, select one of the following:
+
[cols="1a,2a" options="header"]
|===
|Field| Description

|Upload certificate (recommended)
|Use this option to upload a CA-signed server certificate, certificate private key, and optional CA bundle.

|Generate certificate
|Use this option to generate a self-signed certificate. See xref:../admin/configuring-load-balancer-endpoints.adoc[Configure load balancer endpoints] for details of what to enter.

|Use StorageGRID S3 and Swift certificate
|Use this option only if you have already uploaded or generated a custom version of the StorageGRID global certificate. See xref:../admin/configuring-custom-server-certificate-for-storage-node-or-clb.adoc[Configure S3 and Swift API certificates] for details. 

|===

. Select *Finish* to return to the FabricPool and S3 setup wizard.

. Select *Continue* to go to the tenant and bucket step. 

NOTE: Changes to an endpoint certificate can take up to 15 minutes to be applied to all nodes.
--

.Use existing load balancer endpoint
--
. To use an existing endpoint, select its name from the *Select a load balancer endpoint* drop-down list. 
. Select *Continue* to go to the tenant and bucket step. 
--


.Use external load balancer
--

. To use an external load balancer, complete the following fields.
+
[cols="1a,2a" options="header"]
|===
| Field| Description

|FQDN
|The fully qualified domain name (FQDN) of the external load balancer.

|Port
|The port number that S3 will use to connect to the external load balancer.

|Certificate
|Copy the server certificate for the external load balancer and paste it into this field.

|===

. Select *Continue* to go to the tenant and bucket step. 

--
====

// end tabbed area


== Step 3 of 6: Create tenant and bucket

A tenant is an entity that can use S3 applications to store and retrieve objects in StorageGRID. Each tenant has its own users, access keys, buckets, objects, and a specific set of capabilities. You must create a StorageGRID tenant before you can create the bucket that S3 application will use. 

A bucket is a container used to store a tenant's objects and object metadata. Although some tenants might have many buckets, the wizard lets you create or select only one tenant and one bucket at a time. You can use the Tenant Manager later to add any additional buckets you need.

You can create a new tenant and bucket for S3 application use, or you can select an existing tenant and bucket. If you create a new tenant, the system automatically creates the access key ID and secret access key for the tenant's root user.

For details about this task, see xref:creating-s3-bucket-and-access-key.adoc[Create an S3 bucket and obtain an access key].



// start tabbed area

[role="tabbed-block"]
====

.New tenant and bucket
--

To create a new tenant and bucket:

. Select *Create tenant* and enter the following information for the tenant in the *Enter tenant details*:
+

.. *Name*: Enter a name for the tenant account. For example, `S3 tenant`
.. *Description* (optional): Enter a description that helps you identify the tenant.
.. The *Client type* by default is *S3* and is disabled. 
.. *Storage quota* (optional): If you want this tenant to have a storage quota, enter a numerical value for the quota and select the correct units (GB, TB, or PB).
+
. Select the appropriate permissions for the tenant. Some of these permissions have additional requirements. For details, see the online help for each permission.
+
* Allow platform services
* Use own identity source (selectable only if SSO is not being used)
* Allow S3 select (see xref:manage-s3-select-for-tenant-accounts.adoc[Manage S3 Select for tenant accounts])
 
. Select *Continue* and define root access for the tenant account.
+

.. Define root access for the tenant account, based on whether your StorageGRID system uses xref:../admin/using-identity-federation.adoc[identity federation], xref:../admin/configuring-sso.adoc[single sign-on (SSO)], or both. 
+
[cols="1a,2a" options="header"]
|===
| Option 
| To do

|If identity federation is not enabled 
|Specify the password to use when signing into the tenant as the local root user.

|If identity federation is enabled
|Select an existing federated group to have Root access permission for the tenant.

Optionally specify the password to use when signing in to the tenant as the local root user.

|If both identity federation and single sign-on (SSO) are enabled
|Select an existing federated group to have Root access permission for the tenant. No local users can sign in.

|===
+

IMPORTANT: If Create root user S3 access key automatically is checked, an access key ID and secret access key for the root user are created automatically. Select this option only if the root user is the only user and who can have full S3 access. If other users access this tenant, use Tenant Manager to to configure keys and permissions.

.. Select *Continue*.

. Create a bucket for the tenant's object.

.. For *Bucket name*, enter the name of the bucket S3 will use. For example, `S3-bucket`.
+
IMPORTANT: You cannot change the bucket name after creating the bucket.

.. Select the *Region* for this bucket..
+
Use the default region (us-east-1) unless you expect to use ILM in the future to filter objects based on the bucket's region.
+

IMPORTANT: Use *Enable object versioning* if you want to store each version of each object in this bucket. 

.. If you want o create tenant only, select *Create tenant only*, else select *Create tenant and bucket* to create the tenant and bucket and to go to the download data step.

--
====

== Step 4 of 6: Download S3 settings

You can download the file from the StorageGRID and save it in a safe location. The downloaded files includes StorageGRID configuration details,

* Load balancer connection details
* Bucket name

. Select *Download access credential information* to download the credentials details: Tenant account name, Access key ID, and Secret access key.

. Select *Download file* to download and view settings of the Load balancer endpoint, Tenant, Bucket, and the root user credentials.

. Select *Continue* to go to the ILM storage pool step.

== Step 5 of 6: Review ILM rule and ILM policy for S3

Information lifecycle management (ILM) rules control the placement, duration, and ingest behavior for all objects in your StorageGRID system.

// The S3 setup wizard automatically creates the recommended ILM rule for S3 use. This rule applies only to the bucket you specified. It uses 2+1 erasure coding at a single site to store the data that is tiered from ONTAP. 

For details about this step, see xref:../ilm/access-create-ilm-rule-wizard.adoc[Create ILM rule] and xref:best-practices-ilm.adoc[Best practices for using ILM with S3].

=== Things you should do

The ILM policy included with StorageGRID makes two replicated copies of all objects. This policy is in effect until you create a new proposed policy and activate it.

. To add specific instructions for objects belonging to a new S3 tenant or bucket, create a new rule on the ILM rules page. Use basic filters to select the new tenant, bucket, or both.

. Create a new proposed policy on the ILM policies page. Typically, you can clone the existing active policy and add your new rule in the correct location.

. Simulate and then activate the proposed ILM policy. When you activate a policy, StorageGRID uses it to manage all objects in the grid, including existing objects and newly ingested objects.

Check the option *I have reviewed these steps and understand what I need to do* and select *Continue* to go to *Summary*.

== Step 6 of 6: Review summary 

. Review the summary and check for the next steps and configuration settings you can do.
. Select *Finish*.
+
StorageGRID is now ready to ingest data from S3. 

. Go to xref:configure-ontap.adoc[Configure ONTAP System Manager] to enter the saved values and to complete the configuration.